(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{439:function(t,a,e){"use strict";e.r(a);var v=e(8),n=Object(v.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存"}},[t._v("#")]),t._v(" 缓存")]),t._v(" "),a("h2",{attrs:{id:"缓存穿透-cache-penetration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存穿透-cache-penetration"}},[t._v("#")]),t._v(" 缓存穿透（Cache Penetration）")]),t._v(" "),a("p",[a("strong",[t._v("描述")]),t._v("：指缓存和数据库种都没有的数据，而用户不断发起请求。")]),t._v(" "),a("p",[a("strong",[t._v("举例")]),t._v("：黑客用一个不存在的用户 id 获取用户信息，不论缓存还是数据库都没有，大量请求直接把数据库打死。")]),t._v(" "),a("p",[a("strong",[t._v("解决")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("对空值缓存，如 "),a("code",[t._v("set -999 UNKOWN")]),t._v(" 然后设置一个过期时间")]),t._v(" "),a("li",[t._v("设置布隆过滤器，将数据库种所有可能的数据哈希映射在布隆过滤器上，若请求数据的 key 不存在于布隆过滤器上，那数据一定不存在与数据库种，直接返回不存在")]),t._v(" "),a("li",[t._v("设置白名单、黑名单")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zouquchen/Images/main/imgs/Redis-CachePenetration.png",alt:"image-20220721211510307"}})]),t._v(" "),a("h2",{attrs:{id:"缓存击穿-hotspot-invalid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存击穿-hotspot-invalid"}},[t._v("#")]),t._v(" 缓存击穿（Hotspot invalid）")]),t._v(" "),a("p",[a("strong",[t._v("描述")]),t._v("：某个 key 非常热点，访问非常频繁，处于集中式高并发访问的情况，当这个 key 在失效的瞬间，大量的请求在缓存种获取不到数据就直接请求数据库，导致数据库宕机")]),t._v(" "),a("p",[t._v("解决：")]),t._v(" "),a("ul",[a("li",[t._v("缓存数据基本不发生更新，设置热点数据不过期")]),t._v(" "),a("li",[t._v("缓存数据更新不频繁，且缓存刷新的流程耗时较少，使用分布式锁保证仅有少量的请求能请求到数据库并重构缓存")]),t._v(" "),a("li",[t._v("缓存数据更品频繁或缓存刷新耗时较长，定时线程主动刷新化成或者延时过期")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zouquchen/Images/main/imgs/Redis-HotspotInvalid.png",alt:"image-20220721212329737"}})]),t._v(" "),a("h2",{attrs:{id:"缓存雪崩-cache-avalanche"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存雪崩-cache-avalanche"}},[t._v("#")]),t._v(" 缓存雪崩（Cache Avalanche）")]),t._v(" "),a("p",[a("strong",[t._v("描述")]),t._v("：指缓存中数据大批量到期，而查询数据量巨大，引起数据库压力过大甚至宕机。")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://github.com/doocs/advanced-java/blob/main/docs/high-concurrency/redis-caching-avalanche-and-caching-penetration.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v("看到另一种说法，缓存因意外全部宕机，所有请求全部落到数据库，把数据库打死。不知道哪一种说法是对的。")])]),t._v(" "),a("p",[a("strong",[t._v("区别")]),t._v("：和缓存击穿不同的是，缓存击穿指并发查同一条数据，缓存雪崩是不同数据都过期了，很多数据都查不到而查数据库。")]),t._v(" "),a("p",[a("strong",[t._v("解决")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("设置热点数据不过期")]),t._v(" "),a("li",[t._v("过期时间随机，防止同一时间大量过期")]),t._v(" "),a("li",[t._v("分布式部署时将不同数据分布在不同缓存数据中")])])])}),[],!1,null,null,null);a.default=n.exports}}]);